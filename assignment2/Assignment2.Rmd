---
title: "Assignment 1"
author: "Group 69: Dmitrijs Voronovs (2779206), Nikita ..., Alina ..."
date: "24.02.2023"
output: 
  pdf_document: 
    latex_engine: lualatex
fontsize: 11pt
highlight: tango
editor_options: 
  markdown: 
    wrap: 72
---

## Exercise 1

```{=html}
<!--# 
The Amsterdamsche Bos forestry wishes to estimate the total wood volume of the trees on its domain. To this end the forestry has cut a sample of 59 trees of their most prevalent types beech and oak and collected the data from the cut trees in the file treeVolume.txt Download treeVolume.txt. The volume of these trees alongside with their height and trunk diameter have been measured; these are the columns volume, height and diameter, respectively. Column type gives the tree type: Beech or Oak. The tree type, height and diameter can be measured in the field without sacrificing the tree. The forestry hypothesizes that these are predictive of the wood volume.
 -->
```
### a)

```{=html}
<!--# 
a)  Investigate whether the tree type influences volume by performing ANOVA, without taking diameter and height into account. Can a t-test be related to the above ANOVA test? Estimate the volumes for the two tree types.
 -->
```
```{r echo = T, results = 'hide'}
treeVolume = read.table("treeVolume.txt", header = T)
head(treeVolume)
```

```{r echo = F, results = 'hide'}
volumelm = lm(volume ~ factor(type), data = treeVolume)
anova(volumelm)
```

Since P value for type is 0.1736, it indicates that we fail to reject
the null hypothesis and conclude that there is no significant difference
in mean volume between the beech and oak trees.

```{r}
par(mfrow=c(1,2))
qqnorm(residuals(volumelm))
plot(fitted(volumelm), residuals(volumelm))
par(mfrow=c(1,1))
```

After testing the data for normality, it becomes obvious that there is a
deviation of residuals from the normal distribution. As ANOVA
assumptions have been violated, p-value may not be reliable.

```{r echo = T, results = 'hide'}
t.test(volume ~ factor(type), data=treeVolume)
```

T-test shows the p-value 0.1659, indicating that we do not reject a null
hypothesis. That indicated the difference in means between volumes of
beech and oak is different.

T-test also displays estimates of mean for group beech (30.17097) and
oak (35.25000)

### b)

```{=html}
<!--# 
b)  Now include diameter and height as explanatory variables into the analysis. Investigate whether the influence of diameter on volume is similar for the both tree types. Do the same for the influence of height on volume. (Consider at most one (relevant) pairwise interaction per model.) Comment.
 -->
```
```{r results='hide'}
volumeFulllm1 = lm(volume ~ factor(height) + factor(type) * factor(diameter), data = treeVolume)
anova(volumeFulllm1)
```

<!--#TODO: clarify that summary shows only factor(type)oak.Should we use separate data for each model i.e. oak_data <- subset(treeVolume, type == "oak")-->

```{r}
volumeFulllm2 = lm(volume ~ factor(diameter) + factor(type) * factor(height), data = treeVolume)
anova(volumeFulllm2)
```

### c)

```{=html}
<!--# 

c)  Using the results from c), investigate how diameter, height and type influence volume. Comment. Using the resulting model, predict the volume for a tree with the (overall) average diameter and height?

 -->
```
```{r}
volumeFulllm = lm(volume ~ factor(diameter) + factor(height) + factor(type), data = treeVolume)
anova(volumeFulllm)
```

<!--# TODO: how to comment? -->

```{r}
# TODO: how to use mean here? We were training on factors
# d = mean(treeVolume$diameter)
# h = mean(treeVolume$height)
d = median(treeVolume$diameter)
h = median(treeVolume$height)
avgTree = data.frame(diameter=d, height=h, type="oak")
avgTrees = data.frame(diameter=c(d,d), height=c(h,h), type=c("oak", "beech"))

predict(volumeFulllm, avgTree, interval = 'prediction')
```

### d)

```{=html}
<!--# 

d)  Propose a transformation of the explanatory variables that possibly yields a better model (verify this).  (Hint: think of a natural link between the response and explanatory variables.)

 -->
```
The least significant factor can be removed from the explanation, which
is type, as when calculating the volume only height and diameter should
be of a significance. However, while type by itself does nothing, it
explains the height or the diameter, therefore its interaction with one
of other factors should be included.

```{r}
volumeOptimallm = lm(volume ~ factor(diameter) + factor(height) + factor(height):factor(type), data = treeVolume)
anova(volumeOptimallm)
```

<!--# TODO: is it good enough? How to measure the model effectivnesS? lecture 8, Diagnostic in linear regression?? -->

## Exercise 2

### a)

### b)

### c)

### d)

## Exercise 3

### a)

### b)

### c)

### d)

### e)

## Exercise 4

### a)

### b)

### c)
