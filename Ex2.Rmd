---
title: "Assignment 1"
author: "Group 69"
date: "24.02.2023"
output: pdf_document
fontsize: 11pt
highlight: tango
editor_options: 
  markdown: 
    wrap: 72
---

# Assignment 1

## Exercise 1

## Exercise 2. Cholesterol

*A study tested whether cholesterol was reduced after using a certain
brand of margarine as part of a low fat low cholesterol diet. The data
set
[cholesterol.txt](https://canvas.vu.nl/courses/68030/files/5971196?wrap=1 "cholesterol.txt")contains
information on 18 people using margarine to reduce cholesterol: columns
Before and After8weeks contain the cholesterol level (mmol/L)
respectively before the diet and after 8 weeks on the diet.*

*a)  Make some relevant plots of this data set, comment on normality.
Are there any inconsistencies in the data? Investigate whether the
columns Before and After8weeks are correlated.*

```{r}
data = read.table("cholesterol.txt")
attach(data)
head(data)
```

```{r}
par(mfrow=c(1,2))
qqnorm(Before, main="Before")
qqnorm(After8weeks, main="After")
par(mfrow=c(1,1))
```

Both before and after follow the normal distribution.

```{r}
par(mfrow=c(1,2))
hist(Before, main="Before")
hist(After8weeks, main="After")
par(mfrow=c(1,1))
```

According to the histograms and boxplots, we can see that both Before
and After columns are approximately normal. There are no major
inconsistencies in the data.

```{r}
boxplot(Before, After8weeks, names = c("Before", "After"))
```

```{r}
cor.test(Before, After8weeks)
```

And have a high correlation

```{r}
plot(Before, After8weeks)
```

*b)  Apply two relevant tests (cf. Lectures 2, 3) to verify whether the
diet with low fat margarine has an effect (argue whether the data are
paired or not). Is a permutation test applicable?*

As each row represents the cholesterol level (mmol/L) respectively
before the diet and after 8 weeks on the diet for every person, paired
tests can be conducted.

```{r}
t.test(Before, After8weeks, paired=T)
# symmetric data is required
wilcox.test(Before, After8weeks, paired=T)
```

Both tests showed p values \< .05 which indicates that the we reject
$H_0$ and accept $H_a$ , so **the low fat margarine diet has an effect
on reduing cholesterol levels**.

Additionally, permutation test can be conducted, however due to the
small sample size of 18 entries, test may not be reliable and paired
t-test and Wilcoxon signed-rank test may be more appropriate.

<!--# Should we make a permutation test? It's enough-->

*c)  Let* $X_1,\ldots,X_{18}$ *be the column After8weeks. Assume*
$X_1,\ldots,X_{18}\sim \text{Unif}[3,\theta]$, then use the central
limit theorem to find an estimate $\hat{\theta}$ *for* $\theta$ *and
construct a 95%-CI for* $\theta$*. Can you improve this CI?*

```{r}
x_bar <- mean(After8weeks)
s <- sd(After8weeks)

# calculate estimate of theta and 95% CI
theta_hat <- x_bar + qnorm(0.975) * s / sqrt(length(After8weeks))
ci <- c(x_bar - qnorm(0.975) * s / sqrt(length(After8weeks)), theta_hat)

# print results
cat("Estimate of theta:", theta_hat, "\n")
cat("95% CI for theta:", ci, "\n")
```

To improve the CI, we could try using a bootstrap approach to estimate
the distribution of $\hat{\theta}$ and calculate a percentile CI.

<!--# bootstrap here?? -->

```{r}
# calculate the sample mean and standard deviation
x_bar <- mean(After8weeks)

# calculate the standard error of the mean
se <- sd(After8weeks) / sqrt(length(After8weeks))

# calculate the confidence interval using the t-distribution
t_val <- qt(0.025, df = length(After8weeks) - 1, lower.tail = F)
ci <- x_bar + t_val * se * c(-1, 1)
cat("95% confidence interval using t-distribution:", ci, "\n")

# calculate the confidence interval using the normal distribution
z_val <- qnorm(0.025, lower.tail = F)
ci2 <- x_bar + z_val * se * c(-1, 1)
cat("95% confidence interval using normal distribution:", ci2, "\n")
```

*d)  By using a bootstrap test with test statistic*
$T=\max(X_1,\ldots,X_{18})$*, determine those* $\theta\in[3,12]$*, for
which the hypothesis* $X_1,\ldots,X_{18}\sim \text{Unif}[3,\theta]$ *is
not rejected. Can the Kolmogorov-Smirnov test be also applied for this
situation?*

```{r}
#3.2
```

```{r}
# calculate the sample mean and standard deviation
x_bar <- mean(After8weeks)

# calculate the standard error of the mean
se <- sd(After8weeks) / sqrt(length(After8weeks))

# calculate the confidence interval using the t-distribution
t_val <- qt(0.025, df = length(After8weeks) - 1, lower.tail = F)
ci <- x_bar + t_val * se * c(-1, 1)
cat("95% confidence interval using t-distribution:", ci, "\n")

# calculate the confidence interval using the normal distribution
z_val <- qnorm(0.025, lower.tail = F)
ci2 <- x_bar + z_val * se * c(-1, 1)
cat("95% confidence interval using normal distribution:", ci2, "\n")
```

*e)  Using an appropriate test, verify whether the median cholesterol
level after 8 weeks of low fat diet is less than 6. Next, design and
perform a test to check whether the fraction of the cholesterol levels
after 8 weeks of low fat diet less than 4.5 is at most 25%.*

```{r}
#median shift
# wilcox.test(Before, After8weeks, paired=T, alternative = "greater", conf.int=T)
# reject, so greater
# median(After8weeks) < 6
wilcox.test(After8weeks, mu=6, alternative="less")
wilcox.test(After8weeks, mu = 6, alternative = "greater", exact = FALSE)
```

Based on the output, we can see that the p-value is 0.223, which is
greater than 0.05. Therefore, we fail to reject the null hypothesis and
conclude that there is not enough evidence to suggest that the median
cholesterol level after 8 weeks of low fat diet is less than 6.

```{r}
# Store the Before and After8weeks data
Before <- c(6.42, 6.76, 6.56, 4.8, 8.43, 7.49, 8.05, 5.05, 5.77, 3.91, 6.77, 6.44, 6.17, 7.67, 7.34, 6.85, 5.13, 5.73)
After8weeks <- c(5.75, 6.13, 5.71, 4.15, 7.67, 7.05, 7.1, 4.67, 5.33, 3.66, 5.96, 5.64, 5.51, 6.96, 6.82, 6.29, 4.45, 5.17)

# Calculate the observed test statistic
obs_stat <- median(Before - After8weeks)

# Set the number of permutations
n_perm <- 10000

# Initialize an empty vector to store the permuted test statistics
perm_stats <- numeric(n_perm)

# Permute the data and calculate the test statistic for each permutation
for (i in 1:n_perm) {
  perm_data <- sample(c(Before, After8weeks), size = length(Before), replace = FALSE)
  perm_stat <- median(perm_data[1:length(Before)] - perm_data[(length(Before)+1):(2*length(Before))])
  perm_stats[i] <- perm_stat
}

# Calculate the p-value
p_val <- mean(perm_stats <= obs_stat)

# Print the results
cat("Observed test statistic:", obs_stat, "\n")
cat("Permutation p-value:", p_val, "\n")
```

another alg

```{r}
less_than_4.5 <- sum(After8weeks < 4.5)
binom.test(less_than_4.5, length(After8weeks), p = 0.25, alternative = "less")
```

The p-value of 0.3057 suggests that there is no significant evidence to
reject the null hypothesis, which in this case is that the fraction of
cholesterol levels after the low-fat diet is less than 4.5 is at most
25%.

The confidence interval of (0.0000000, 0.3766792) suggests that the true
fraction of cholesterol levels after the low-fat diet less than 4.5
could range from 0 (which is not possible) to 0.3766792. Since the
p-value is not significant, this confidence interval should be
interpreted with caution.

The probability of success of 0.1666667 indicates that only 1 out of the
6 participants had a cholesterol level after the low-fat diet less than
4.5, which is a low probability of success. However, as the p-value is
not significant, we cannot conclude that this difference is
statistically significant.

## Exercise 3

## Exercise 4
